<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="PurchaseDS" targetNamespace="http://tempuri.org/PurchaseDS.xsd" xmlns:mstns="http://tempuri.org/PurchaseDS.xsd" xmlns="http://tempuri.org/PurchaseDS.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="MySQLconnString" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="MySQLconnString (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.Cognitivo.Properties.Settings.GlobalReference.Default.MySQLconnString" Provider="MySql.Data.MySqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="PurchaseVatReportTableAdapter" GeneratorDataComponentClassName="PurchaseVatReportTableAdapter" Name="PurchaseVatReport" UserDataComponentName="PurchaseVatReportTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="MySQLconnString (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillBy" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetDataBy" GeneratorSourceName="FillBy" GetMethodModifier="Public" GetMethodName="GetDataBy" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="FillBy">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	branch.name as Branch,
	DATE_FORMAT(s.trans_date,'%d %b %y') as InvoiceDate, 
    contact.name as Customer, 
    s.number as InvoiceNumber, 
    
	round(sum(sd.quantity * sd.unit_cost),4) as Totalpurchase,
    vatco.name as VAT,
	round(sum(sd.quantity * sd.unit_cost * vatco.vat),4) as TotalVAT,
    round(sum(sd.quantity * sd.unit_cost * vatco.coef),4) as Total_WithVAT
    
FROM  purchase_invoice s INNER JOIN
         contacts as contact ON s.id_contact = contact.id_contact 
         INNER JOIN 
         app_branch as branch on s.id_branch = branch.id_branch
         inner join 
         purchase_invoice_detail sd ON s.id_purchase_invoice = sd.id_purchase_invoice 
         LEFT OUTER JOIN 
             (SELECT app_vat_group.id_vat_group, app_vat_group.name as name, sum(app_vat.coefficient) as vat, sum(app_vat.coefficient) + 1 AS coef
            FROM  app_vat_group LEFT OUTER JOIN 
                     app_vat_group_details ON app_vat_group.id_vat_group = app_vat_group_details.id_vat_group LEFT OUTER JOIN 
                     app_vat ON app_vat_group_details.id_vat = app_vat.id_vat
            GROUP BY app_vat_group.id_vat_group) vatco ON vatco.id_vat_group = sd.id_vat_group
  where s.status = 2 and (s.trans_date &gt;= @StartDate) and (s.trans_date &lt;= @EndDate) 
group by s.id_purchase_invoice, vatco.id_vat_group
 order by s.trans_date</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="StartDate" ColumnName="trans_date" DataSourceName="angelius128.purchase_invoice" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@StartDate" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="trans_date" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="EndDate" ColumnName="trans_date" DataSourceName="angelius128.purchase_invoice" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@EndDate" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="trans_date" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="Branch" DataSetColumn="Branch" />
              <Mapping SourceColumn="InvoiceDate" DataSetColumn="InvoiceDate" />
              <Mapping SourceColumn="Customer" DataSetColumn="Customer" />
              <Mapping SourceColumn="InvoiceNumber" DataSetColumn="InvoiceNumber" />
              <Mapping SourceColumn="Totalpurchase" DataSetColumn="Totalpurchase" />
              <Mapping SourceColumn="VAT" DataSetColumn="VAT" />
              <Mapping SourceColumn="TotalVAT" DataSetColumn="TotalVAT" />
              <Mapping SourceColumn="Total_WithVAT" DataSetColumn="Total_WithVAT" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="MySQLconnString (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FillByBranch" GenerateMethods="Both" GenerateShortCommands="true" GeneratorGetMethodName="GetDataByBranch" GeneratorSourceName="FillByBranch" GetMethodModifier="Public" GetMethodName="GetDataByBranch" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataByBranch" UserSourceName="FillByBranch">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT 
	branch.name as Branch,
	DATE_FORMAT(s.trans_date,'%d %b %y') as InvoiceDate, 
    contact.name as Customer, 
    s.number as InvoiceNumber, 
    
	round(sum(sd.quantity * sd.unit_cost),4) as Totalpurchase,
    vatco.name as VAT,
	round(sum(sd.quantity * sd.unit_cost * vatco.vat),4) as TotalVAT,
    round(sum(sd.quantity * sd.unit_cost * vatco.coef),4) as Total_WithVAT
    
FROM  purchase_invoice s INNER JOIN
         contacts as contact ON s.id_contact = contact.id_contact 
         INNER JOIN 
         app_branch as branch on s.id_branch = branch.id_branch
         inner join 
         purchase_invoice_detail sd ON s.id_purchase_invoice = sd.id_purchase_invoice 
         LEFT OUTER JOIN 
             (SELECT app_vat_group.id_vat_group, app_vat_group.name as name, sum(app_vat.coefficient) as vat, sum(app_vat.coefficient) + 1 AS coef
            FROM  app_vat_group LEFT OUTER JOIN 
                     app_vat_group_details ON app_vat_group.id_vat_group = app_vat_group_details.id_vat_group LEFT OUTER JOIN 
                     app_vat ON app_vat_group_details.id_vat = app_vat.id_vat
            GROUP BY app_vat_group.id_vat_group) vatco ON vatco.id_vat_group = sd.id_vat_group
  where s.id_branch = @BranchID and s.status = 2 and (s.trans_date &gt;= @StartDate) and (s.trans_date &lt;= @EndDate) 
group by s.id_purchase_invoice, vatco.id_vat_group
 order by s.trans_date</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="BranchID" ColumnName="id_branch" DataSourceName="angelius128.purchase_invoice" DataTypeServer="int(11)" DbType="Int32" Direction="Input" ParameterName="@BranchID" Precision="0" ProviderType="Int32" Scale="0" Size="0" SourceColumn="id_branch" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="StartDate" ColumnName="trans_date" DataSourceName="angelius128.purchase_invoice" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@StartDate" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="trans_date" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="EndDate" ColumnName="trans_date" DataSourceName="angelius128.purchase_invoice" DataTypeServer="datetime" DbType="DateTime" Direction="Input" ParameterName="@EndDate" Precision="0" ProviderType="DateTime" Scale="0" Size="0" SourceColumn="trans_date" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="PurchaseDS" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="PurchaseDS" msprop:Generator_UserDSName="PurchaseDS">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="PurchaseVatReport" msprop:Generator_TableClassName="PurchaseVatReportDataTable" msprop:Generator_TableVarName="tablePurchaseVatReport" msprop:Generator_TablePropName="PurchaseVatReport" msprop:Generator_RowDeletingName="PurchaseVatReportRowDeleting" msprop:Generator_RowChangingName="PurchaseVatReportRowChanging" msprop:Generator_RowEvHandlerName="PurchaseVatReportRowChangeEventHandler" msprop:Generator_RowDeletedName="PurchaseVatReportRowDeleted" msprop:Generator_UserTableName="PurchaseVatReport" msprop:Generator_RowChangedName="PurchaseVatReportRowChanged" msprop:Generator_RowEvArgName="PurchaseVatReportRowChangeEvent" msprop:Generator_RowClassName="PurchaseVatReportRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Branch" msprop:Generator_ColumnVarNameInTable="columnBranch" msprop:Generator_ColumnPropNameInRow="Branch" msprop:Generator_ColumnPropNameInTable="BranchColumn" msprop:Generator_UserColumnName="Branch" type="xs:string" />
              <xs:element name="InvoiceDate" msprop:Generator_ColumnVarNameInTable="columnInvoiceDate" msprop:Generator_ColumnPropNameInRow="InvoiceDate" msprop:Generator_ColumnPropNameInTable="InvoiceDateColumn" msprop:Generator_UserColumnName="InvoiceDate" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="38" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Customer" msprop:Generator_ColumnVarNameInTable="columnCustomer" msprop:Generator_ColumnPropNameInRow="Customer" msprop:Generator_ColumnPropNameInTable="CustomerColumn" msprop:Generator_UserColumnName="Customer" type="xs:string" />
              <xs:element name="InvoiceNumber" msprop:Generator_ColumnVarNameInTable="columnInvoiceNumber" msprop:Generator_ColumnPropNameInRow="InvoiceNumber" msprop:Generator_ColumnPropNameInTable="InvoiceNumberColumn" msprop:Generator_UserColumnName="InvoiceNumber" type="xs:string" minOccurs="0" />
              <xs:element name="Totalpurchase" msprop:Generator_ColumnVarNameInTable="columnTotalpurchase" msprop:Generator_ColumnPropNameInRow="Totalpurchase" msprop:Generator_ColumnPropNameInTable="TotalpurchaseColumn" msprop:Generator_UserColumnName="Totalpurchase" type="xs:decimal" minOccurs="0" />
              <xs:element name="VAT" msprop:Generator_ColumnVarNameInTable="columnVAT" msprop:Generator_ColumnPropNameInRow="VAT" msprop:Generator_ColumnPropNameInTable="VATColumn" msprop:Generator_UserColumnName="VAT" type="xs:string" minOccurs="0" />
              <xs:element name="TotalVAT" msprop:Generator_ColumnVarNameInTable="columnTotalVAT" msprop:Generator_ColumnPropNameInRow="TotalVAT" msprop:Generator_ColumnPropNameInTable="TotalVATColumn" msprop:Generator_UserColumnName="TotalVAT" type="xs:decimal" minOccurs="0" />
              <xs:element name="Total_WithVAT" msprop:Generator_ColumnVarNameInTable="columnTotal_WithVAT" msprop:Generator_ColumnPropNameInRow="Total_WithVAT" msprop:Generator_ColumnPropNameInTable="Total_WithVATColumn" msprop:Generator_UserColumnName="Total_WithVAT" type="xs:decimal" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>